include = env/env_preprod.conf
include = env/metrics.conf

#Global Properties

topology.name=sourcefire
debug.mode=true
local.mode=true
num.workers=1

#Spout
spout.test.num.tasks=1
spout.test.parallelism.hint=1

#Parser Bolt
bolt.parser.num.tasks=1
bolt.parser.parallelism.hint=1

#Alerts Bolt (Static Configuration)
bolt.alerts.num.tasks=1
bolt.alerts.parallelism.hint=1
bolt.alerts.staticpriority=3
bolt.alerts.staticsource=sourcefire

#GeoEnrichment
bolt.enrichment.geo.num.tasks=1
bolt.enrichment.geo.parallelism.hint=1
bolt.enrichment.geo.geo_enrichment_tag=geo_enrichment
bolt.enrichment.geo.source_ip=ip_src_addr
bolt.enrichment.geo.resp_ip=ip_dst_addr
bolt.enrichment.geo.adapter.table=GEO
bolt.enrichment.geo.MAX_CACHE_SIZE=10000
bolt.enrichment.geo.MAX_TIME_RETAIN=10

#WhoisEnrichment
bolt.enrichment.whois.num.tasks=1
bolt.enrichment.whois.parallelism.hint=1
bolt.enrichment.whois.whois_enrichment_tag=whois_enrichment
bolt.enrichment.whois.source=host
bolt.enrichment.whois.MAX_CACHE_SIZE=10000
bolt.enrichment.whois.MAX_TIME_RETAIN=10

#Indexing Bolt
bolt.indexing.num.tasks=1
bolt.indexing.parallelism.hint=1
bolt.indexing.indexname=sourcefire_index
bolt.indexing.documentname=sourcefire_doc
bolt.indexing.bulk=2

#HDFS Bolt
bolt.hdfs.num.tasks=1
bolt.hdfs.parallelism.hint=1
bolt.hdfs.size.rotation.policy=5
bolt.hdfs.size.sink.policy=5